import csv
from pathlib import Path

# Define paths
csv_file = 'input.csv'             # Your input CSV file
template_file = 'template.xml'     # XML template file with 'replace jn'
output_dir = Path('output_xmls')   # Directory for output XMLs

# Make sure output directory exists
output_dir.mkdir(exist_ok=True)

# Read the XML template
with open(template_file, 'r', encoding='utf-8') as f:
    xml_template = f.read()

# Process each row in the CSV
with open(csv_file, 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    
    for index, row in enumerate(reader):
        if len(row) < 2:
            continue  # Skip if not enough columns
        
        number_to_replace = row[1].strip()
        updated_xml = xml_template.replace("replace jn", number_to_replace)
        
        # Write the updated XML to a new file
        output_filename = output_dir / f'output_{index+1}.xml'
        with open(output_filename, 'w', encoding='utf-8') as out_file:
            out_file.write(updated_xml)

print(f"XML files created in folder: {output_dir.resolve()}")
